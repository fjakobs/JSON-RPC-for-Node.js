<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>JSON-RPC</title>
	<meta name="generator" content="TextMate http://macromates.com/">
	<meta name="author" content="Martin Wittemann">
	<!-- Date: 2009-11-28 -->
	
	<style type="text/css" media="screen">
	  body {
	    font-family: Verdana;
	    font-size: 13px;
      line-height:0.8em;	    
	  }
	  
	  h2 {
	    font-size: 16px;
      margin-top: 10px;
	  }
	  
	  h3 {
	    font-size: 15px;
	    margin-bottom: 5px;
	  }
	  
    th {
      font-size: 13px;
      padding: 0px;
    }
	  
	</style>
	
	<script type="text/javascript" charset="utf-8">
	  function sendPost() {
      var value = document.getElementById("postData").value;
      
      var xhr = new XMLHttpRequest();
      xhr.open("POST", "http://localhost:8000/", true);
      xhr.setRequestHeader("Content-type", "application/json-rpc");
      xhr.setRequestHeader("Content-length", value.lenth);
      xhr.setRequestHeader("Connection", "close");
      send(xhr, value);
	  }
	  
	  function sendGet() {
      var params = "?" + "method=" + document.getElementById("method").value +
        "&params=" + document.getElementById("params").value +
        "&id=" + document.getElementById("id").value;
      
      var xhr = new XMLHttpRequest();
      xhr.open("GET", "http://localhost:8000/" + params, true);
      xhr.setRequestHeader("Content-type", "application/json-rpc");
      send(xhr);
	  }
	  
	  function send (xhr, data) {
	    xhr.onreadystatechange = function() {
        if (xhr.readyState == 4 && xhr.status == 200) {
          document.getElementById("result").innerHTML = (xhr.responseText);
        } else if (xhr.readyState == 4 && xhr.status == 204) {
          document.getElementById("result").innerHTML = ("Notification send!");          
        }
      }
      xhr.send(data);
	  }
	  
	  function filin(button) {
	    var value = button.value;
      // set post data
      document.getElementById("postData").value = value;
	  }
	</script>
</head>
<body>
  <h2>Requests</h2>
  <table border="0" cellspacing="5" cellpadding="5" style="width: 500px">
    <tr><th>GET</th><th>POST</th></tr>
    <tr>
      <td>
        <p><label for="method">method</label>: <input type="text" id="method" value="echo" id="method"></p>
        <p><label for="params">params</label>: <input type="text" id="params" value="['abc']" id="params"></p>
        <p><label for="id">id</label>: <input type="text" id="id" value="99" id="id"></p>
        <p><input type="submit" value="&rarr;" onClick="sendGet()"></p>
      </td>
      <td> 
        <p>
          <textarea id="postData" cols="30" rows="4">{"method": "echo", "params": ["abc"], "id": "99"}</textarea>
        </p>
        <p><input type="submit" value="&rarr;" onClick="sendPost()"></p>
      </td>
    </tr> 
  </table>
  <h3>Results</h3>
  <input type="button" value="clear" onclick="document.getElementById('result').innerHTML = '';">
  <span id="result"></span>
  <h2>Test-Requests</h2>
  <input onclick="filin(this)" type='button' value='{"method": "note", "params": ["user1", "we were just talking"], "id": null}'><br>
  <input onclick="filin(this)" type='button' value='{"method": "echo", "params": ["Hello all!"], "id": 99}'><br>
  <input onclick="filin(this)" type='button' value='{"method": "add", "params": [1, 2], "id": 111}'> 

</body>
</html>
